<html>
    <head>
        <title>CSE Books</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet"> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css" integrity="sha512-6S2HWzVFxruDlZxI3sXOZZ4/eJ8AcxkQH1+JjSe/ONCEqR9L4Ysq5JdT5ipqtzU7WHalNwzwBv+iE51gNHJNqQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
      </head>
    <style>
h1,a,p,h4,button{
    font-family: Montserrat;
    color: whitesmoke;
}
#sb:link, #sb:visited {
  background-color: #FF5964;
  color: white;
  padding: 8px 15px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  border-radius: 15px;
  font-family: Montserrat;
  font-size: small;
}

#sb:hover, #sb:active {
  background-color: red;}
body{
    background-color:#5286F3;
}
    </style>
    <body>
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
              <div class="navbar-header">
                <a class="navbar-brand" href="#">Online Companion - Virtual Books</a>
              </div>
              <ul class="nav navbar-nav">
                <li><a href="/dashboard">Home</a></li>
                <li><a href="/cse">CSE</a></li>
                <li><a href="/ece">ECE</a></li>
              </ul>
              <ul class="nav navbar-nav navbar-right">
                <li><a href="#"><span class="glyphicon glyphicon-user"></span> <%=uname %></a></li>
                <li><a href="/logout"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
              </ul>
            </div>
          </nav> 
          <h1 class="container">COLLEGE SPL BOOKS</h1>
          <div class="card" style="margin: 5%;background-color: black;color: cornsilk;border-radius: 15px;">
            <div class="card-body" style="padding: 3%;">
              <h4 class="card-title">GATE</h4>
              <br>
              <p class="card-text">Cost - 549/-</p>
              <hr>
              <button class="btn-warning" style="width: 100px;height: 40px;background-color: #FF5964;" onclick=ConfirmDialog(0)>Download</button>
            </div>
          </div> 
          <div class="card" style="margin: 5%;background-color: black;color: cornsilk;border-radius: 15px;">
            <div class="card-body" style="padding: 3%;">
              <h4 class="card-title">GRE</h4>
              <br>
              <p class="card-text">Cost - 799/-</p>
              <hr>
              <button class="btn-warning" style="width: 100px;height: 40px;background-color: #FF5964;" onclick=ConfirmDialog(1)>Download</button>
            </div>
          </div>
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
          <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css" rel="stylesheet" />
          <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js" integrity="sha512-lbwH47l/tPXJYG9AcFNoJaTMhGvYWhVM9YI43CT+uteTRRaiLCui8snIgyAN8XWgNjNhCqlAUdzZptso6OCoFQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.colorbox/1.6.4/jquery.colorbox-min.js"></script>
          <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
          <script>
          function ConfirmDialog(id) {
            message = "The amount will be added to your Total Due. Confirm this step ?"
            $('<div></div>').appendTo('body')
              .html('<div><h6>' + message + '</h6></div>')
              .dialog({
                modal: true,
                title: 'Delete message',
                zIndex: 10000,
                autoOpen: true,
                width: '600',
                resizable: false,
                buttons: {
                  Yes: function() {
                    //alert("/spl/"+id);
                    $.ajax({
                      url: "/spl/"+id,
                      type: 'GET',
                      success: function(data){
                        var us = data.user.username,c=data.cost,bid=data.bid,bn=data.bn,sid=data.tid;
                        $('<div></div>').appendTo('body')
                        .html('<div><h6>Username : '+us+'</h6><h6>Bookname : '+bn+'</h6><h6>BookID : '+bid+'</h6><h6>Book cost : '+c+'</h6><h6>Transaction ID : '+sid+'</h6></div>')
                        .dialog({
                        modal: true,
                        title: 'Receipt',
                        zIndex: 10000,
                        autoOpen: true,
                        width: '600',
                        resizable: false,
                        buttons:{
                          close:  function(event, ui) {
                          $(this).remove();}
                         }
                      })

                        toastr.success('Purchase Successful. Due amount has been updated!!');
                        var w = window.open(data.link,'_blank');
                        if(w){w.focus()}
                        else{alert("Please allow POPUP's to download the softcopy!!")}
                      },
                      error: function(err){
                        alert(err);
                      }                      
                    })
                    //alert("af spl"+id);
                   $(this).dialog("close");
                  },
                  No: function() {
                    $(this).dialog("close");
                  }
                },
                close: function(event, ui) {
                  $(this).remove();
                }
              });
          };
          
          </script>
    </body>
</html>